import{c,o as d,a as t,t as p,F as v,g as y,_ as $,D as w,r as _,u as m,b as u,q as f,s as F,d as j,f as k,e as N,h as A,l as h,v as I,i as M,j as B,k as q,w as T,m as x,x as E,y as O,z as U,n as P,p as J}from"./index.es-BkDqJwlU.js";const L={class:"name-list"},H={class:"name-list-ul"},V=["onClick"],Y={name:"StudentMenu",props:{students:{required:!0,default:[{fname:"Joost",id:9999}],type:Array},current:{required:!0,default:{fname:"Joost",id:9999},type:Object}}},S=Object.assign(Y,{setup(e){const s=n=>{localStorage.setItem("student",n),window.location.href=`/manage/${n}`};return(n,a)=>(d(),c("details",null,[t("summary",null,p(e.current.fname),1),t("div",L,[t("ul",H,[(d(!0),c(v,null,y(e.students,o=>(d(),c("li",{key:o.id_short,class:"name-list-li"},[t("a",{onClick:l=>s(o.id_short)},p(o.fname),9,V)]))),128))])])]))}}),g=e=>{if(e===void 0)return"";let s=new Date(e);return`${s.getMonth()+1}/${s.getDate()}/${s.getFullYear()}`},b=e=>{if(e===void 0)return"";let s=new Date(e);return`${s.getHours().toString().padStart(2,"0")}:${s.getMinutes().toString().padStart(2,"0")}`},R=(e,s,n)=>{const a=new Date(e).getTime();let l=new Date(s).getTime()-a,i=Math.ceil(l/1e3/60/60);return n*i},z=["id"],G={class:"row-top"},K={key:0,class:"table-text check-table"},Q={key:1,class:"table-text check-table"},W={class:"table-text id-table"},X={class:"table-text date-table"},Z={class:"table-text time-table class-in"},ee={class:"table-text time-table class-in"},te={class:"table-text rate-table"},se={class:"table-text charge-table"},ne={class:"table-text btn-table"},ae=["id"],ie={class:"table-input check-table-input"},le=["id"],oe=["id"],de=["for"],ce={class:"table-input date-table"},re=["id","value"],ue={class:"table-input time-table class-in"},me=["id","value"],he={class:"table-input time-table class-in"},pe=["id","value"],be={class:"table-input rate-table"},fe=["id","value"],_e={class:"table-input btn-table-input"},ge={name:"Session",props:{selected:{required:!1,default:"false",type:String},paid:{required:!1,default:"false",type:String},id:{required:!0,default:9999,unique:!0,type:Number},time_in:{required:!1,default:Date.now()-1e3*60*60,type:Date},time_out:{required:!1,default:Date.now(),type:Date},rate:{required:!0,default:65,type:Number}},components:[$,w],methods:{async editSession(){const e=document.getElementById(`${this.id}-paid`).checked,s=document.getElementById(`${this.id}-date`).value,n=document.getElementById(`${this.id}-intime`).value,a=document.getElementById(`${this.id}-outtime`).value,o=document.getElementById(`${this.id}-rate`).value;let l=new Date(s),i=this.parseTime(n),r=this.parseTime(a);i.setDate(l.getDate()),i.setMonth(l.getMonth()),i.setFullYear(l.getFullYear()),r.setDate(l.getDate()),r.setMonth(l.getMonth()),r.setFullYear(l.getFullYear()),await(await fetch("http://localhost:8081/api/sessions/update",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({student:Number(localStorage.getItem("student")),number:this.id,paid:e,in_time:i,out_time:r,rate:o})})).json(),window.location.reload()},parseTime(e){const s=new Date,n=/^\d{1,2}\.\d{1,2}$/,a=/^\d{1,2}:\d{2}/,o=/^\d{3,4}$/;if(n.test(e)){let l=e.split(".");s.setHours(Number(l[0])),s.setMinutes(Number(l[1]))}else if(a.test(e)){let l=e.split(":");s.setHours(Number(l[0])),s.setMinutes(Number(l[1]))}else if(o.test(e)){let l=e.substring(e.length-2),i=e.substring(0,e.length-2);s.setHours(Number(i)),s.setMinutes(Number(l))}return s},async deleteSession(){await(await fetch("http://localhost:8081/api/sessions/delete",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({number:this.id,student:localStorage.getItem("student")})})).json(),window.location.reload()}}},C=Object.assign(ge,{emits:["selected"],setup(e,{emit:s}){const n=s,a=o=>{document.querySelector(`#details-${o}`).classList.toggle("hidden")};return(o,l)=>{const i=_("font-awesome-icon");return d(),c("div",{id:`row-${e.id}`,class:F(`session-row ${e.paid?"":"unpaid"}`)},[t("div",G,[e.selected?(d(),c("span",K,[t("input",{type:"checkbox",checked:"",onChange:l[0]||(l[0]=r=>n("selected"))},null,32)])):(d(),c("span",Q,[t("input",{type:"checkbox",unchecked:"",onChange:l[1]||(l[1]=r=>n("selected"))},null,32)])),t("span",W,p(e.id),1),t("span",X,p(m(g)(e.time_in)),1),t("span",Z,p(m(b)(e.time_in)),1),t("span",ee,p(m(b)(e.time_out)),1),t("span",te,"$"+p(e.rate),1),t("span",se,"$"+p(m(R)(e.time_in,e.time_out,e.rate)),1),t("span",ne,[u($,{onClicked:l[2]||(l[2]=r=>a(e.id)),should_switch:"true"})])]),t("div",{id:`details-${e.id}`,class:"row-bottom hidden"},[t("span",ie,[e.paid?(d(),c("input",{key:0,type:"checkbox",id:`${e.id}-paid`,checked:""},null,8,le)):(d(),c("input",{key:1,type:"checkbox",id:`${e.id}-paid`,unchecked:""},null,8,oe)),t("label",{for:`${e.id}-paid`},"Paid",8,de)]),t("span",ce,[t("input",{type:"text",id:`${e.id}-date`,value:`${m(g)(e.time_in)}`},null,8,re)]),t("span",ue,[t("input",{type:"text",id:`${e.id}-intime`,value:`${m(b)(e.time_in)}`},null,8,me)]),t("span",he,[t("input",{type:"text",id:`${e.id}-outtime`,value:`${m(b)(e.time_out)}`},null,8,pe)]),t("span",be,[t("input",{type:"text",id:`${e.id}-rate`,value:e.rate},null,8,fe)]),t("span",_e,[t("button",{class:"btn btn-add",onClick:l[3]||(l[3]=(...r)=>o.editSession&&o.editSession(...r))},[u(i,{icon:"save"})]),l[4]||(l[4]=f("   ")),u(w,{onClick:o.deleteSession},null,8,["onClick"])])],8,ae)],10,z)}}}),ve={name:"NameMenu",props:{fname:{required:!0,default:"",type:String},lname:{required:!0,default:"",type:String},active:{required:!0,default:!0,type:Boolean}},methods:{saveClick:async()=>{const e=document.getElementById("fname").value,s=document.getElementById("lname").value,n=document.getElementById("active").checked;await(await fetch("http://localhost:8081/api/students/update",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id_short:localStorage.getItem("student"),fname:e,lname:s,active:n})})).json(),window.location.reload()}}},ye={class:"edit-name"},$e=["value"],we=["value"],ke={key:0,class:"table-text check-table"},Se={key:1,class:"table-text check-table"};function Ce(e,s,n,a,o,l){const i=_("font-awesome-icon");return d(),c("div",ye,[s[3]||(s[3]=t("label",{for:"fname"},"Name",-1)),t("input",{type:"text",id:"fname",value:n.fname},null,8,$e),t("input",{type:"text",id:"lname",value:n.lname},null,8,we),s[4]||(s[4]=t("label",{for:"active"},"Active",-1)),n.active?(d(),c("span",ke,s[1]||(s[1]=[t("input",{type:"checkbox",id:"active",checked:""},null,-1)]))):(d(),c("span",Se,s[2]||(s[2]=[t("input",{type:"checkbox",id:"active",unchecked:""},null,-1)]))),t("button",{class:"btn btn-save",onClick:s[0]||(s[0]=r=>l.saveClick())},[u(i,{icon:"save"})])])}const D=j(ve,[["render",Ce]]),De={id:"main"},Fe={class:"tile"},je={class:"header-left"},Ne={class:"nav-back btn",href:"/"},Ae={class:"session-controls"},Ie={class:"date-range"},Me=["value"],Be=["value"],qe={id:"session-table"},Te={class:"table-header"},xe={class:"check-table"},Ee={class:"check-list"},Oe={class:"check-list-ul"},Ue={class:"check-list-li"},Pe={class:"check-list-li"},Je={class:"check-list-li"},Le={class:"check-list-li"},He={class:"check-list-li"},Ve={class:"table-text btn-table"},Ye={class:"row-container"},Re={name:"app",components:{StudentMenu:S,AuthMenu:k,Session:C,NameMenu:D},async mounted(){await this.getSessions(),await this.getStudents(),this.createDateFilter()},methods:{async getSessions(){const s=await(await fetch(`http://localhost:8081/api/sessions/read/${localStorage.getItem("student")}`)).json();this.Sessions=s.data,this.Filtered=s.data},async getStudents(){const s=await(await fetch("http://localhost:8081/api/students/read")).json();this.AllStudents=s.data,this.CurrentStudent=s.data.filter(n=>n.id_short===Number(localStorage.getItem("student")))[0]},async get_invoice(){const s=await(await fetch("http://localhost:8081/api/sessions/invoice",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({student:this.CurrentStudent,sessions:this.Filtered.filter(a=>a.selected).sort((a,o)=>a.number>o.number)})})).blob(),n=window.URL.createObjectURL(s);window.open(n)},createDateFilter(){const e=this.Sessions[this.Sessions.length-1].in_time,s=this.Sessions[0].in_time;this.Dates={start:e,end:s}},filterDates(){const e=new Date(document.getElementById("date-start").value);let s=new Date(document.getElementById("date-end").value);s.setHours(23),s.setMinutes(59),this.Dates.start=e,this.Dates.end=s,this.Filtered=this.Filtered.filter(n=>new Date(n.in_time)>=e&&new Date(n.in_time)<=s)},resetDateFilter(){this.createDateFilter(),this.viewAllSessions()},viewAllSessions(){this.Filtered=this.Sessions},viewPaidSessions(){this.Filtered=this.Sessions.filter(e=>e.paid===!0)},viewUnpaidSessions(){this.Filtered=this.Sessions.filter(e=>e.paid===!1)},checkFiltered(){this.Filtered=this.Filtered.map(e=>(e.selected=!0,e))},uncheckFiltered(){this.Filtered=this.Filtered.map(e=>(e.selected=!1,e))},updateFiltered(e){this.Filtered=this.Filtered.map(s=>(s.number===e&&(s.selected=!s.selected),s))}},data(){return{Sessions:[],Filtered:[],AllStudents:[],CurrentStudent:{},Dates:{start:void 0,end:void 0}}}},ze=Object.assign(Re,{setup(e){const s=async()=>{await(await fetch("http://localhost:8081/api/sessions/add",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({student:Number(localStorage.getItem("student")),in_time:Date.now()-36e5,out_time:Date.now(),rate:65,paid:!1})})).json(),window.location.reload()};return(n,a)=>{const o=_("font-awesome-icon"),l=_("add-student");return d(),c("main",De,[t("div",Fe,[t("header",null,[t("span",je,[a[9]||(a[9]=t("a",{class:"screen-reader-only"},"Skip to Content",-1)),t("a",Ne,[u(o,{icon:"caret-left"}),a[8]||(a[8]=f(" Back"))])]),u(S,{current:n.CurrentStudent,students:n.AllStudents},null,8,["current","students"]),u(k)]),t("div",Ae,[t("button",{class:"btn btn-invoice",onClick:a[0]||(a[0]=(...i)=>n.get_invoice&&n.get_invoice(...i))},[u(o,{icon:"print"}),a[10]||(a[10]=f(" Invoice"))]),t("button",{class:"btn btn-add-class",onClick:s},"New Class"),t("span",Ie,[t("input",{type:"text",id:"date-start",value:m(g)(n.Dates.start)},null,8,Me),a[11]||(a[11]=f(" – ")),t("input",{type:"text",id:"date-end",value:m(g)(n.Dates.end)},null,8,Be),t("button",{class:"btn btn-dates",onClick:a[1]||(a[1]=(...i)=>n.filterDates&&n.filterDates(...i))},"Filter"),t("button",{class:"btn btn-dates",onClick:a[2]||(a[2]=(...i)=>n.resetDateFilter&&n.resetDateFilter(...i))},"Reset")])]),t("div",qe,[t("div",Te,[t("span",xe,[t("details",null,[t("summary",null,[u(o,{icon:"list-check"})]),t("div",Ee,[t("ul",Oe,[t("li",Ue,[t("a",{href:"#",onClick:a[3]||(a[3]=(...i)=>n.checkFiltered&&n.checkFiltered(...i))},"Check All")]),t("li",Pe,[t("a",{href:"#",onClick:a[4]||(a[4]=(...i)=>n.uncheckFiltered&&n.uncheckFiltered(...i))},"Uncheck All")]),t("li",Je,[t("a",{href:"#",onClick:a[5]||(a[5]=(...i)=>n.viewAllSessions&&n.viewAllSessions(...i))},"View All")]),t("li",Le,[t("a",{href:"#",onClick:a[6]||(a[6]=(...i)=>n.viewPaidSessions&&n.viewPaidSessions(...i))},"Paid")]),t("li",He,[t("a",{href:"#",onClick:a[7]||(a[7]=(...i)=>n.viewUnpaidSessions&&n.viewUnpaidSessions(...i))},"Unpaid")])])])])]),a[12]||(a[12]=N('<span class="table-text id-table">#</span><span class="table-text date-table">Date</span><span class="table-text time-table">In</span><span class="table-text time-table">Out</span><span class="table-text rate-table">Rate</span><span class="table-text charge-table">Charge</span>',6)),t("span",Ve,[u(l)])]),t("div",Ye,[(d(!0),c(v,null,y(n.Filtered,i=>(d(),A(C,{key:i.number,selected:i.selected,paid:i.paid,id:i.number,time_in:i.in_time,time_out:i.out_time,rate:i.rate,onSelected:r=>n.updateFiltered(i.number)},null,8,["selected","paid","id","time_in","time_out","rate","onSelected"]))),128))])]),u(D,{fname:n.CurrentStudent.fname,lname:n.CurrentStudent.lname,active:n.CurrentStudent.active},null,8,["fname","lname","active"])])])}}});h.add(I);h.add(M);h.add(B);h.add(q);h.add(T);h.add(x);h.add(E);h.add(O);h.add(U);P(ze).component("font-awesome-icon",J).mount("#app");
