import{c as d,o,a as n,t as m,F as y,i as w,_ as p,y as u,z as k,A as _,B as j,b as r,d as b,n as S,g as f,f as $,r as N,w as v,e as I,h as A,j as B,l as h,C as U,k as q,m as M,p as E,D as O,q as x,s as T,E as L,u as P,v as J,x as R}from"./index.es-DxxZWXdY.js";/* empty css                   */const V={class:"name-list"},H={class:"name-list-ul"},Y=["onClick"],z={name:"StudentMenu",props:{students:{required:!0,default:[{fname:"Joost",id:9999}],type:Array},current:{required:!0,default:{fname:"Joost",id:9999},type:Object}}},C=Object.assign(z,{setup(t){const e=s=>{localStorage.setItem("student",s),window.location.href=`/manage/${s}`};return(s,l)=>(o(),d("details",null,[n("summary",null,m(t.current.fname),1),n("div",V,[n("ul",H,[(o(!0),d(y,null,w(t.students,a=>(o(),d("li",{key:a.id_short,class:"name-list-li"},[n("a",{onClick:i=>e(a.id_short)},m(a.fname),9,Y)]))),128))])])]))}}),G=["id"],K={class:"row-top"},Q={key:0,class:"table-text check-table"},W={key:1,class:"table-text check-table"},X={class:"table-text id-table"},Z={class:"table-text date-table"},ee={class:"table-text time-table class-in"},te={class:"table-text time-table class-in"},se={class:"table-text rate-table"},ne={class:"table-text charge-table"},ae={class:"table-text btn-table"},ie=["id"],le={class:"table-input check-table-input"},oe=["id"],de=["id"],re=["for"],ce={class:"table-input date-table"},ue=["id","value"],me={class:"table-input time-table class-in"},pe=["id","value"],he={class:"table-input time-table class-in"},be=["id","value"],fe={class:"table-input rate-table"},ge=["id","value"],_e={class:"table-input btn-table-input"},ke={name:"Session",props:{selected:{required:!1,default:!1,type:Boolean},paid:{required:!1,default:!1,type:Boolean},id:{required:!0,default:9999,unique:!0,type:Number},time_in:{required:!1,default:Date.now()-1e3*60*60,type:String},time_out:{required:!1,default:Date.now(),type:String},rate:{required:!0,default:65,type:Number}},components:[p],methods:{async editSession(){const t=document.getElementById(`${this.id}-paid`).checked,e=document.getElementById(`${this.id}-date`).value,s=document.getElementById(`${this.id}-intime`).value,l=document.getElementById(`${this.id}-outtime`).value,a=document.getElementById(`${this.id}-rate`).value;let i=new Date(e),c=this.parseTime(s),g=this.parseTime(l);c.setDate(i.getDate()),c.setMonth(i.getMonth()),c.setFullYear(i.getFullYear()),g.setDate(i.getDate()),g.setMonth(i.getMonth()),g.setFullYear(i.getFullYear()),await(await fetch("/api/sessions/update",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({student:Number(localStorage.getItem("student")),number:this.id,paid:t,in_time:c,out_time:g,rate:a})})).json(),window.location.reload()},parseTime(t){const e=new Date,s=/^\d{1,2}\.\d{1,2}$/,l=/^\d{1,2}:\d{2}/,a=/^\d{3,4}$/;if(s.test(t)){let i=t.split(".");e.setHours(Number(i[0])),e.setMinutes(Number(i[1]))}else if(l.test(t)){let i=t.split(":");e.setHours(Number(i[0])),e.setMinutes(Number(i[1]))}else if(a.test(t)){let i=t.substring(t.length-2),c=t.substring(0,t.length-2);e.setHours(Number(c)),e.setMinutes(Number(i))}return e},async deleteSession(){const e=await(await fetch("/api/sessions/delete",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({number:this.id,student:localStorage.getItem("student")})})).json();e.error?console.error(e.msg):window.location.reload()}}},F=Object.assign(ke,{emits:["selected"],setup(t,{emit:e}){const s=e,l=a=>{document.querySelector(`#details-${a}`).classList.toggle("hidden")};return(a,i)=>(o(),d("div",{id:`row-${t.id}`,class:S(`session-row ${t.paid?"":"unpaid"}`)},[n("div",K,[t.selected?(o(),d("span",Q,[n("input",{type:"checkbox",checked:"",onChange:i[0]||(i[0]=c=>s("selected"))},null,32)])):(o(),d("span",W,[n("input",{type:"checkbox",unchecked:"",onChange:i[1]||(i[1]=c=>s("selected"))},null,32)])),n("span",X,m(t.id),1),n("span",Z,m(u(k)(t.time_in)),1),n("span",ee,m(u(_)(t.time_in)),1),n("span",te,m(u(_)(t.time_out)),1),n("span",se,"$"+m(t.rate),1),n("span",ne,"$"+m(u(j)(t.time_in,t.time_out,t.rate)),1),n("span",ae,[r(p,{classes:"btn btn-manage",onClicked:i[2]||(i[2]=c=>l(t.id)),base:"pencil",alt:"caret-up"})])]),n("div",{id:`details-${t.id}`,class:"row-bottom hidden"},[n("span",le,[t.paid?(o(),d("input",{key:0,type:"checkbox",id:`${t.id}-paid`,checked:""},null,8,oe)):(o(),d("input",{key:1,type:"checkbox",id:`${t.id}-paid`,unchecked:""},null,8,de)),n("label",{for:`${t.id}-paid`},"Paid",8,re)]),n("span",ce,[n("input",{type:"text",id:`${t.id}-date`,value:`${u(k)(t.time_in)}`},null,8,ue)]),n("span",me,[n("input",{type:"text",id:`${t.id}-intime`,value:`${u(_)(t.time_in)}`},null,8,pe)]),n("span",he,[n("input",{type:"text",id:`${t.id}-outtime`,value:`${u(_)(t.time_out)}`},null,8,be)]),n("span",fe,[n("input",{type:"text",id:`${t.id}-rate`,value:t.rate},null,8,ge)]),n("span",_e,[r(p,{classes:"btn btn-add",onClicked:a.editSession,base:"save"},null,8,["onClicked"]),i[3]||(i[3]=b("   ")),r(p,{classes:"btn btn-del",onClicked:a.deleteSession,base:"minus"},null,8,["onClicked"])])],8,ie)],10,G))}}),ve={class:"edit-name"},ye=["value"],we=["value"],Se={key:0,class:"table-text check-table"},$e={key:1,class:"table-text check-table"},Ce={name:"NameMenu",props:{fname:{required:!0,default:"",type:String},lname:{required:!0,default:"",type:String},active:{required:!0,default:!0,type:Boolean}},components:{IconButton:p},methods:{saveClick:async()=>{const t=document.getElementById("fname").value,e=document.getElementById("lname").value,s=document.getElementById("active").checked,l=f("user");await(await fetch("/api/students/update",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id_short:localStorage.getItem("student"),fname:t,lname:e,active:s,user:l})})).json(),window.location.reload()}}},D=Object.assign(Ce,{setup(t){return(e,s)=>(o(),d("div",ve,[s[2]||(s[2]=n("label",{for:"fname"},"Name",-1)),n("input",{type:"text",id:"fname",value:t.fname},null,8,ye),n("input",{type:"text",id:"lname",value:t.lname},null,8,we),s[3]||(s[3]=n("label",{for:"active"},"Active",-1)),t.active?(o(),d("span",Se,s[0]||(s[0]=[n("input",{type:"checkbox",id:"active",checked:""},null,-1)]))):(o(),d("span",$e,s[1]||(s[1]=[n("input",{type:"checkbox",id:"active",unchecked:""},null,-1)]))),r(p,{classes:"btn btn-save",onClicked:e.saveClick,base:"save"},null,8,["onClicked"])]))}}),Fe={id:"main"},De={class:"tile"},je={class:"header-left"},Ne={class:"nav-back btn",href:"/landing"},Ie={class:"session-controls"},Ae={class:"date-range"},Be=["value"],Ue=["value"],qe={id:"session-table"},Me={class:"table-header"},Ee={class:"check-table"},Oe={class:"check-list"},xe={class:"check-list-ul"},Te={class:"check-list-li"},Le={class:"check-list-li"},Pe={class:"check-list-li"},Je={class:"check-list-li"},Re={class:"check-list-li"},Ve={class:"row-container"},He={key:0,class:S("session-row")},Ye={name:"app",components:{StudentMenu:C,AuthMenu:$,Session:F,NameMenu:D,IconButton:p},async mounted(){this.populateUser(),this.setCurrent(),await this.getSessions(),await this.getStudents(),this.createDateFilter()},methods:{populateUser(){this.User={user:f("user"),displayName:decodeURIComponent(f("displayName")),rate:f("rate")}},setCurrent(){const t=window.location.toString().split("/manage/");t.length===2&&localStorage.setItem("student",Number(t[1]))},async add_session(){const e=await(await fetch("/api/sessions/add",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({student:Number(localStorage.getItem("student")),in_time:Date.now()-36e5,out_time:Date.now(),rate:65,paid:!1})})).json();if(console.log(e.data),e.error)window.alert(e.msg);else{let s=e.data;s.selected=!1,this.Sessions=[s,...this.Sessions],this.Filtered=[s,...this.Filtered]}},async getSessions(){f("user");const e=await(await fetch(`/api/sessions/read/${localStorage.getItem("student")}`)).json();e.error?console.log(e.msg):(this.Sessions=e.data,this.Filtered=e.data)},async getStudents(){const t=f("user"),s=await(await fetch(`/api/students/read/${t}`)).json();s.error?console.log(s.msg):(this.AllStudents=s.data,this.CurrentStudent=s.data.filter(l=>l.id_short===Number(localStorage.getItem("student")))[0])},async get_invoice(){const t=await fetch("/api/sessions/invoice",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({student:this.CurrentStudent,sessions:this.Filtered.filter(e=>e.selected).sort((e,s)=>e.number>s.number)})});if(t.status===200){const e=await t.blob(),s=window.URL.createObjectURL(e);let l=document.createElement("a");l.href=s,l.download=`${this.CurrentStudent.fname}_${this.CurrentStudent.lname}.pdf`,l.click(),window.URL.revokeObjectURL(s)}else{const e=await t.json();window.alert(e.msg)}},createDateFilter(){const t=this.Sessions[this.Sessions.length-1].in_time,e=this.Sessions[0].in_time;this.Dates={start:t,end:e}},filterDates(){const t=new Date(document.getElementById("date-start").value);let e=new Date(document.getElementById("date-end").value);e.setHours(23),e.setMinutes(59),this.Dates.start=t,this.Dates.end=e,this.Filtered=this.Filtered.filter(s=>new Date(s.in_time)>=t&&new Date(s.in_time)<=e)},resetDateFilter(){this.createDateFilter(),this.viewAllSessions()},viewAllSessions(){this.Filtered=this.Sessions},viewPaidSessions(){this.Filtered=this.Sessions.filter(t=>t.paid===!0)},viewUnpaidSessions(){this.Filtered=this.Sessions.filter(t=>t.paid===!1)},checkFiltered(){this.Filtered=this.Filtered.map(t=>(t.selected=!0,t))},uncheckFiltered(){this.Filtered=this.Filtered.map(t=>(t.selected=!1,t))},updateFiltered(t){this.Filtered=this.Filtered.map(e=>(e.number===t&&(e.selected=!e.selected),e))}},data(){return{Sessions:[],Filtered:[],AllStudents:[],CurrentStudent:{},Dates:{start:void 0,end:void 0},User:{}}}},ze=Object.assign(Ye,{setup(t){return(e,s)=>{const l=N("font-awesome-icon");return o(),d("main",Fe,[n("div",De,[n("header",null,[n("span",je,[s[8]||(s[8]=n("a",{class:"screen-reader-only"},"Skip to Content",-1)),n("a",Ne,[r(l,{icon:"caret-left"}),s[7]||(s[7]=b(" Back"))])]),r(C,{current:e.CurrentStudent,students:e.AllStudents},null,8,["current","students"]),r($,null,{default:v(()=>[b(m(e.User.displayName),1)]),_:1})]),n("div",Ie,[r(p,{classes:"btn btn-invoice",onClicked:e.get_invoice,base:"print"},{default:v(()=>s[9]||(s[9]=[b(" Invoice")])),_:1,__:[9]},8,["onClicked"]),r(p,{classes:"btn btn-add-class",onClicked:e.add_session},{default:v(()=>s[10]||(s[10]=[b(" New Class")])),_:1,__:[10]},8,["onClicked"]),n("span",Ae,[n("input",{type:"text",id:"date-start",value:u(k)(e.Dates.start)},null,8,Be),s[11]||(s[11]=b(" – ")),n("input",{type:"text",id:"date-end",value:u(k)(e.Dates.end)},null,8,Ue),n("button",{class:"btn btn-dates",onClick:s[0]||(s[0]=(...a)=>e.filterDates&&e.filterDates(...a))},"Filter"),n("button",{class:"btn btn-dates",onClick:s[1]||(s[1]=(...a)=>e.resetDateFilter&&e.resetDateFilter(...a))},"Reset")])]),n("div",qe,[n("div",Me,[n("span",Ee,[n("details",null,[n("summary",null,[r(l,{icon:"list-check"})]),n("div",Oe,[n("ul",xe,[n("li",Te,[n("a",{href:"#",onClick:s[2]||(s[2]=(...a)=>e.checkFiltered&&e.checkFiltered(...a))},"Check All")]),n("li",Le,[n("a",{href:"#",onClick:s[3]||(s[3]=(...a)=>e.uncheckFiltered&&e.uncheckFiltered(...a))},"Uncheck All")]),n("li",Pe,[n("a",{href:"#",onClick:s[4]||(s[4]=(...a)=>e.viewAllSessions&&e.viewAllSessions(...a))},"View All")]),n("li",Je,[n("a",{href:"#",onClick:s[5]||(s[5]=(...a)=>e.viewPaidSessions&&e.viewPaidSessions(...a))},"Paid")]),n("li",Re,[n("a",{href:"#",onClick:s[6]||(s[6]=(...a)=>e.viewUnpaidSessions&&e.viewUnpaidSessions(...a))},"Unpaid")])])])])]),s[12]||(s[12]=I('<span class="table-text id-table">#</span><span class="table-text date-table">Date</span><span class="table-text time-table">In</span><span class="table-text time-table">Out</span><span class="table-text rate-table">Rate</span><span class="table-text charge-table">Charge</span><span class="table-text btn-table"></span>',7))]),n("div",Ve,[(o(!0),d(y,null,w(e.Filtered,a=>(o(),B(F,{key:a.number,selected:a.selected,paid:a.paid,id:a.number,time_in:a.in_time,time_out:a.out_time,rate:a.rate,onSelected:i=>e.updateFiltered(a.number)},null,8,["selected","paid","id","time_in","time_out","rate","onSelected"]))),128)),e.Filtered.length===0?(o(),d("div",He,s[13]||(s[13]=[n("h5",{class:"table-text rate-table"},"No Classes, add one!",-1)]))):A("",!0)])]),r(D,{fname:e.CurrentStudent.fname,lname:e.CurrentStudent.lname,active:e.CurrentStudent.active},null,8,["fname","lname","active"])])])}}});h.add(U);h.add(q);h.add(M);h.add(E);h.add(O);h.add(x);h.add(T);h.add(L);h.add(P);J(ze).component("font-awesome-icon",R).mount("#app");
