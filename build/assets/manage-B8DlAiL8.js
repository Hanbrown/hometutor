import{c,o,b as s,t as p,F as v,i as y,a as $,_ as w,r as _,u as m,d as u,e as f,v as F,f as j,h as k,g as N,j as A,l as h,w as I,k as M,m as B,n as q,x as T,p as E,y as O,z as x,A as U,q as P,s as J}from"./index.es-Bn8DZCjI.js";const L={class:"name-list"},H={class:"name-list-ul"},V=["onClick"],Y={name:"StudentMenu",props:{students:{required:!0,default:[{fname:"Joost",id:9999}],type:Array},current:{required:!0,default:{fname:"Joost",id:9999},type:Object}}},S=Object.assign(Y,{setup(t){const e=a=>{localStorage.setItem("student",a),window.location.href=`/manage/${a}`};return(a,l)=>(o(),c("details",null,[s("summary",null,p(t.current.fname),1),s("div",L,[s("ul",H,[(o(!0),c(v,null,y(t.students,i=>(o(),c("li",{key:i.id_short,class:"name-list-li"},[s("a",{onClick:n=>e(i.id_short)},p(i.fname),9,V)]))),128))])])]))}}),g=t=>{if(t===void 0)return"";let e=new Date(t);return`${e.getMonth()+1}/${e.getDate()}/${e.getFullYear()}`},b=t=>{if(t===void 0)return"";let e=new Date(t);return`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`},R=(t,e,a)=>{const l=new Date(t).getTime();let n=new Date(e).getTime()-l,d=Math.ceil(n/1e3/60/60);return a*d},z=["id"],G={class:"row-top"},K={key:0,class:"table-text check-table"},Q={key:1,class:"table-text check-table"},W={class:"table-text id-table"},X={class:"table-text date-table"},Z={class:"table-text time-table class-in"},ee={class:"table-text time-table class-in"},te={class:"table-text rate-table"},se={class:"table-text charge-table"},ne={class:"table-text btn-table"},ae=["id"],ie={class:"table-input check-table-input"},le=["id"],oe=["id"],de=["for"],ce={class:"table-input date-table"},re=["id","value"],ue={class:"table-input time-table class-in"},me=["id","value"],he={class:"table-input time-table class-in"},pe=["id","value"],be={class:"table-input rate-table"},fe=["id","value"],_e={class:"table-input btn-table-input"},ge={name:"Session",props:{selected:{required:!1,default:"false",type:String},paid:{required:!1,default:"false",type:String},id:{required:!0,default:9999,unique:!0,type:Number},time_in:{required:!1,default:Date.now()-1e3*60*60,type:Date},time_out:{required:!1,default:Date.now(),type:Date},rate:{required:!0,default:65,type:Number}},components:[$,w],methods:{async editSession(){const t=document.getElementById(`${this.id}-paid`).checked,e=document.getElementById(`${this.id}-date`).value,a=document.getElementById(`${this.id}-intime`).value,l=document.getElementById(`${this.id}-outtime`).value,i=document.getElementById(`${this.id}-rate`).value;let n=new Date(e),d=this.parseTime(a),r=this.parseTime(l);d.setDate(n.getDate()),d.setMonth(n.getMonth()),d.setFullYear(n.getFullYear()),r.setDate(n.getDate()),r.setMonth(n.getMonth()),r.setFullYear(n.getFullYear()),await(await fetch("/api/sessions/update",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({student:Number(localStorage.getItem("student")),number:this.id,paid:t,in_time:d,out_time:r,rate:i})})).json(),window.location.reload()},parseTime(t){const e=new Date,a=/^\d{1,2}\.\d{1,2}$/,l=/^\d{1,2}:\d{2}/,i=/^\d{3,4}$/;if(a.test(t)){let n=t.split(".");e.setHours(Number(n[0])),e.setMinutes(Number(n[1]))}else if(l.test(t)){let n=t.split(":");e.setHours(Number(n[0])),e.setMinutes(Number(n[1]))}else if(i.test(t)){let n=t.substring(t.length-2),d=t.substring(0,t.length-2);e.setHours(Number(d)),e.setMinutes(Number(n))}return e},async deleteSession(){await(await fetch("/api/sessions/delete",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({number:this.id,student:localStorage.getItem("student")})})).json(),window.location.reload()}}},C=Object.assign(ge,{emits:["selected"],setup(t,{emit:e}){const a=e,l=i=>{document.querySelector(`#details-${i}`).classList.toggle("hidden")};return(i,n)=>{const d=_("font-awesome-icon");return o(),c("div",{id:`row-${t.id}`,class:F(`session-row ${t.paid?"":"unpaid"}`)},[s("div",G,[t.selected?(o(),c("span",K,[s("input",{type:"checkbox",checked:"",onChange:n[0]||(n[0]=r=>a("selected"))},null,32)])):(o(),c("span",Q,[s("input",{type:"checkbox",unchecked:"",onChange:n[1]||(n[1]=r=>a("selected"))},null,32)])),s("span",W,p(t.id),1),s("span",X,p(m(g)(t.time_in)),1),s("span",Z,p(m(b)(t.time_in)),1),s("span",ee,p(m(b)(t.time_out)),1),s("span",te,"$"+p(t.rate),1),s("span",se,"$"+p(m(R)(t.time_in,t.time_out,t.rate)),1),s("span",ne,[u($,{onClicked:n[2]||(n[2]=r=>l(t.id)),should_switch:"true"})])]),s("div",{id:`details-${t.id}`,class:"row-bottom hidden"},[s("span",ie,[t.paid?(o(),c("input",{key:0,type:"checkbox",id:`${t.id}-paid`,checked:""},null,8,le)):(o(),c("input",{key:1,type:"checkbox",id:`${t.id}-paid`,unchecked:""},null,8,oe)),s("label",{for:`${t.id}-paid`},"Paid",8,de)]),s("span",ce,[s("input",{type:"text",id:`${t.id}-date`,value:`${m(g)(t.time_in)}`},null,8,re)]),s("span",ue,[s("input",{type:"text",id:`${t.id}-intime`,value:`${m(b)(t.time_in)}`},null,8,me)]),s("span",he,[s("input",{type:"text",id:`${t.id}-outtime`,value:`${m(b)(t.time_out)}`},null,8,pe)]),s("span",be,[s("input",{type:"text",id:`${t.id}-rate`,value:t.rate},null,8,fe)]),s("span",_e,[s("button",{class:"btn btn-add",onClick:n[3]||(n[3]=(...r)=>i.editSession&&i.editSession(...r))},[u(d,{icon:"save"})]),n[4]||(n[4]=f("   ")),u(w,{onClick:i.deleteSession},null,8,["onClick"])])],8,ae)],10,z)}}}),ve={name:"NameMenu",props:{fname:{required:!0,default:"",type:String},lname:{required:!0,default:"",type:String},active:{required:!0,default:!0,type:Boolean}},methods:{saveClick:async()=>{const t=document.getElementById("fname").value,e=document.getElementById("lname").value,a=document.getElementById("active").checked;await(await fetch("/api/students/update",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id_short:localStorage.getItem("student"),fname:t,lname:e,active:a})})).json(),window.location.reload()}}},ye={class:"edit-name"},$e=["value"],we=["value"],ke={key:0,class:"table-text check-table"},Se={key:1,class:"table-text check-table"};function Ce(t,e,a,l,i,n){const d=_("font-awesome-icon");return o(),c("div",ye,[e[3]||(e[3]=s("label",{for:"fname"},"Name",-1)),s("input",{type:"text",id:"fname",value:a.fname},null,8,$e),s("input",{type:"text",id:"lname",value:a.lname},null,8,we),e[4]||(e[4]=s("label",{for:"active"},"Active",-1)),a.active?(o(),c("span",ke,e[1]||(e[1]=[s("input",{type:"checkbox",id:"active",checked:""},null,-1)]))):(o(),c("span",Se,e[2]||(e[2]=[s("input",{type:"checkbox",id:"active",unchecked:""},null,-1)]))),s("button",{class:"btn btn-save",onClick:e[0]||(e[0]=r=>n.saveClick())},[u(d,{icon:"save"})])])}const D=j(ve,[["render",Ce]]),De={id:"main"},Fe={class:"tile"},je={class:"header-left"},Ne={class:"nav-back btn",href:"/"},Ae={class:"session-controls"},Ie={class:"date-range"},Me=["value"],Be=["value"],qe={id:"session-table"},Te={class:"table-header"},Ee={class:"check-table"},Oe={class:"check-list"},xe={class:"check-list-ul"},Ue={class:"check-list-li"},Pe={class:"check-list-li"},Je={class:"check-list-li"},Le={class:"check-list-li"},He={class:"check-list-li"},Ve={class:"table-text btn-table"},Ye={class:"row-container"},Re={name:"app",components:{StudentMenu:S,AuthMenu:k,Session:C,NameMenu:D},async mounted(){await this.getSessions(),await this.getStudents(),this.createDateFilter()},methods:{async add_session(){await(await fetch("/api/sessions/add",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({student:Number(localStorage.getItem("student")),in_time:Date.now()-36e5,out_time:Date.now(),rate:65,paid:!1})})).json(),window.location.reload()},async getSessions(){const e=await(await fetch(`/api/sessions/read/${localStorage.getItem("student")}`)).json();this.Sessions=e.data,this.Filtered=e.data},async getStudents(){const e=await(await fetch("/api/students/read")).json();this.AllStudents=e.data,this.CurrentStudent=e.data.filter(a=>a.id_short===Number(localStorage.getItem("student")))[0]},async get_invoice(){const e=await(await fetch("/api/sessions/invoice",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({student:this.CurrentStudent,sessions:this.Filtered.filter(l=>l.selected).sort((l,i)=>l.number>i.number)})})).blob(),a=window.URL.createObjectURL(e);window.open(a)},createDateFilter(){const t=this.Sessions[this.Sessions.length-1].in_time,e=this.Sessions[0].in_time;this.Dates={start:t,end:e}},filterDates(){const t=new Date(document.getElementById("date-start").value);let e=new Date(document.getElementById("date-end").value);e.setHours(23),e.setMinutes(59),this.Dates.start=t,this.Dates.end=e,this.Filtered=this.Filtered.filter(a=>new Date(a.in_time)>=t&&new Date(a.in_time)<=e)},resetDateFilter(){this.createDateFilter(),this.viewAllSessions()},viewAllSessions(){this.Filtered=this.Sessions},viewPaidSessions(){this.Filtered=this.Sessions.filter(t=>t.paid===!0)},viewUnpaidSessions(){this.Filtered=this.Sessions.filter(t=>t.paid===!1)},checkFiltered(){this.Filtered=this.Filtered.map(t=>(t.selected=!0,t))},uncheckFiltered(){this.Filtered=this.Filtered.map(t=>(t.selected=!1,t))},updateFiltered(t){this.Filtered=this.Filtered.map(e=>(e.number===t&&(e.selected=!e.selected),e))}},data(){return{Sessions:[],Filtered:[],AllStudents:[],CurrentStudent:{},Dates:{start:void 0,end:void 0}}}},ze=Object.assign(Re,{setup(t){return(e,a)=>{const l=_("font-awesome-icon"),i=_("add-student");return o(),c("main",De,[s("div",Fe,[s("header",null,[s("span",je,[a[10]||(a[10]=s("a",{class:"screen-reader-only"},"Skip to Content",-1)),s("a",Ne,[u(l,{icon:"caret-left"}),a[9]||(a[9]=f(" Back"))])]),u(S,{current:e.CurrentStudent,students:e.AllStudents},null,8,["current","students"]),u(k)]),s("div",Ae,[s("button",{class:"btn btn-invoice",onClick:a[0]||(a[0]=(...n)=>e.get_invoice&&e.get_invoice(...n))},[u(l,{icon:"print"}),a[11]||(a[11]=f(" Invoice"))]),s("button",{class:"btn btn-add-class",onClick:a[1]||(a[1]=(...n)=>e.add_session&&e.add_session(...n))},"New Class"),s("span",Ie,[s("input",{type:"text",id:"date-start",value:m(g)(e.Dates.start)},null,8,Me),a[12]||(a[12]=f(" – ")),s("input",{type:"text",id:"date-end",value:m(g)(e.Dates.end)},null,8,Be),s("button",{class:"btn btn-dates",onClick:a[2]||(a[2]=(...n)=>e.filterDates&&e.filterDates(...n))},"Filter"),s("button",{class:"btn btn-dates",onClick:a[3]||(a[3]=(...n)=>e.resetDateFilter&&e.resetDateFilter(...n))},"Reset")])]),s("div",qe,[s("div",Te,[s("span",Ee,[s("details",null,[s("summary",null,[u(l,{icon:"list-check"})]),s("div",Oe,[s("ul",xe,[s("li",Ue,[s("a",{href:"#",onClick:a[4]||(a[4]=(...n)=>e.checkFiltered&&e.checkFiltered(...n))},"Check All")]),s("li",Pe,[s("a",{href:"#",onClick:a[5]||(a[5]=(...n)=>e.uncheckFiltered&&e.uncheckFiltered(...n))},"Uncheck All")]),s("li",Je,[s("a",{href:"#",onClick:a[6]||(a[6]=(...n)=>e.viewAllSessions&&e.viewAllSessions(...n))},"View All")]),s("li",Le,[s("a",{href:"#",onClick:a[7]||(a[7]=(...n)=>e.viewPaidSessions&&e.viewPaidSessions(...n))},"Paid")]),s("li",He,[s("a",{href:"#",onClick:a[8]||(a[8]=(...n)=>e.viewUnpaidSessions&&e.viewUnpaidSessions(...n))},"Unpaid")])])])])]),a[13]||(a[13]=N('<span class="table-text id-table">#</span><span class="table-text date-table">Date</span><span class="table-text time-table">In</span><span class="table-text time-table">Out</span><span class="table-text rate-table">Rate</span><span class="table-text charge-table">Charge</span>',6)),s("span",Ve,[u(i)])]),s("div",Ye,[(o(!0),c(v,null,y(e.Filtered,n=>(o(),A(C,{key:n.number,selected:n.selected,paid:n.paid,id:n.number,time_in:n.in_time,time_out:n.out_time,rate:n.rate,onSelected:d=>e.updateFiltered(n.number)},null,8,["selected","paid","id","time_in","time_out","rate","onSelected"]))),128))])]),u(D,{fname:e.CurrentStudent.fname,lname:e.CurrentStudent.lname,active:e.CurrentStudent.active},null,8,["fname","lname","active"])])])}}});h.add(I);h.add(M);h.add(B);h.add(q);h.add(T);h.add(E);h.add(O);h.add(x);h.add(U);P(ze).component("font-awesome-icon",J).mount("#app");
